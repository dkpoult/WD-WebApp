<section *ngIf="gotCourse" style="padding: 15px;">
  <h1 mat-dialog-title>Edit Course</h1>
  <form [formGroup]="form" (ngSubmit)="submit(form)">
    <mat-dialog-content>
      <mat-form-field>
        <mat-label>Course Code</mat-label>
        <input matInput disabled="true" value="{{ courseCode }}">
      </mat-form-field>
      <mat-form-field>
        <mat-label>Course Name</mat-label>
        <input matInput formControlName="name">
        <mat-error>
          Please enter a course name
        </mat-error>
      </mat-form-field>
      <mat-form-field>
        <mat-label>Course Description</mat-label>
        <mat-hint>(Optional)</mat-hint>
        <textarea matInput formControlName="description"></textarea>
      </mat-form-field>
      <mat-form-field>
        <mat-label>Enrolment Key</mat-label>
        <mat-hint>(Optional)</mat-hint>
        <input matInput formControlName="password">
      </mat-form-field>
      <mat-checkbox formControlName="clearKey" [hidden]="!course.hasPassword" (change)="toggleClearKey()">
        Clear Enrolment Key
      </mat-checkbox>
      <div formArrayName="sessions" style="padding-top: 20px;">
        <mat-label>Sessions</mat-label>
        <mat-card class="session-card" *ngFor="let session of form.controls['sessions'].controls; let i = index"
          formGroupName="{{i}}">
          <mat-card-content>
            <mat-form-field>
              <mat-label>Duration</mat-label>
              <span matSuffix>minutes</span>
              <input matInput formControlName="duration">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Type</mat-label>
              <mat-select formControlName="sessionType">
                <mat-option [value]="'LECTURE'">Lecture</mat-option>
                <mat-option [value]="'LAB'">Lab</mat-option>
                <mat-option [value]="'TUTORIAL'">Tutorial</mat-option>
                <mat-option [value]="'TEST'">Test</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Venue</mat-label>
              <input matInput formControlName="venue">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Repeats</mat-label>
              <mat-select formControlName="repeatType">
                <mat-option [value]="'ONCE'">Never</mat-option>
                <mat-option [value]="'DAILY'">Daily</mat-option>
                <mat-option [value]="'WEEKLY'">Weekly</mat-option>
                <mat-option [value]="'MONTHLY'">Monthly</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field *ngIf="this.form.get('sessions').get('0').get('repeatType').value !== 'ONCE'">
              <mat-label>Every</mat-label>
              <span matSuffix [ngSwitch]="this.form.get('sessions').get('0').get('repeatType').value">
                <span *ngSwitchCase="'DAILY'">
                  day(s)
                </span>
                <span *ngSwitchCase="'WEEKLY'">
                  week(s)
                </span>
                <span *ngSwitchCase="'MONTHLY'">
                  month(s)
                </span>
              </span>
              <input matInput type="number" formControlName="repeatGap">
            </mat-form-field>
          </mat-card-content>
          <mat-card-actions>
            <button mat-icon-button type="button" (click)="removeSession(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
        <button mat-button type="button" (click)="addSession()">
          <mat-icon>add</mat-icon>Add new Session
        </button>
      </div>
    </mat-dialog-content>
    <mat-dialog-actions>
      <span fxFlex></span>
      <button mat-button [disabled]=" hasErrors()" type="submit">Apply</button>
      <button mat-button type="button" routerLink="../../" color="warn">Back</button>
      <span fxFlex></span>
    </mat-dialog-actions>
  </form>
</section>